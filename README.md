# Intro
This repository contains exploratory code implementing a Verifiably-Encrypted Signature Scheme.

It is an implementation of 4.4 described in [Aggregate and Verifiably Encrypted Signatures from Bilinear Maps](https://crypto.stanford.edu/~dabo/pubs/papers/aggreg.pdf),
on the BLS12-381 curve. It uses the guidelines proposed in [On Cryptographic Protocols Employing Asymmetric Pairings – The Role Of ψ Revisited](https://eprint.iacr.org/2009/480.pdf) to adapt the scheme from
a Type 2 pairing to a Type 3 (BLS12-381).

# Running
```
docker build -t bls-vess .
docker run --rm -ti bls-vess
```

# Sample run

```
Alice's pubkey (G1): 020e51d966eaa770475e388ba733e928fd634d4e6a59a7cffda551d49375b26af56749f767f0f562ec5c1a304c5c2b0f087c3aab1e944af102a39f071e26d390d8d80f786cebf24937c83d63e88c10eba9f8fa0dec8e6a6e51939257538606ca
Adjudicator pubkey (G1): 045cd9219ad5d467c55090ffc7440a7cb8049603d4ab98b13661357e9ab32980b8332b84c9f8e622c7feaad4d4e074710e8ee10ce42560fa3f11514665e130371da75e4839167f71b1e4e38ec8a30cd52313a0e6d90c6f710c2c302784cd044e
Adjudicator pubkey (G2): 0cddb69a10bcc72436ba2cc30f44eb21525572d86c4b383c2898220c8d40e09fc7bda16e85d530058d2968ba25a2a4d00c45d611a0d5c68577b4c1d60ccfcec6abe17ed4fc17c15d44e9e6d86e44507a0d342b8b7195849cfaaf49d3c28e2a180bcdfd1aa22ffae70b777764baab8a352d8baff2739270d6474eca3ba607fdc5efcb30d79e4a9ab192f665776fbc3c6f0f8458f41b709b7e19d303eaaef5ba9dceb01f1ecd09a55d284d5af97d40f4a1ca2f96dec6bcc0f8cfc21a1127d34d2b
Message: Hello, World
Original signature: 154076da22e2b56a29ad822516eda7b64f7f84ad8b255a81b6397bb27465903fe288bd1789a6dc7cc42311ff5651de1011d82896d8c52a4c374550a8f3251ff5899d8e6f41a8f4295ad910db12b58b68e0ffc519916da13aaba27ee70c63d114182da47c5598412334c859f858b98a97f351fa81efa3a3d0fa5dd744009c2443944223d58932b3847b58d688913013dc18255a1f755a7f419785c90ca64811b4eb534c984b3bf1218b2648771ece12074b72678d9104e789762ca69d44d900a5
VESig: (154798956558f5e3f1b85e038fea37966e2e843aa022b01ad813199f7cfe512aba4a0689f3df90332d038dde89afa50514b9586239d181460cae9cc62cc359634a2e489d5f14d4c1af4a0d024319e528b97f695de96cb1781ef7e27d45175f260f25a4dd9b26211bcc09c4d1d01d3a1212eeb4b392b46ca3a3ae7d607f5b0f61d496872147ccb4d4a73527e8b3dd4b091127fdb8c44ba7d4510f684c3e190e692544a8a54c722804a3fac1d5e5294d93d32a559884e2bb65a5071cd29676f929, 0ca3700e189dafe48c6504561a2b1e224a2b13623abf048b4c16f0677b358a1e3058400062b3af9ec262e680b6db961413cf71d54e0bbaa3d88e6d2da96db610cc73a875c359a59737a081c1f42b0573abd7758d6e4c2f9ed1e3c83f5ea6f436069be1387c2c45e3a7a896c14acfcbc3d7076e9b068c71d2fa06b7fdfd8cadd6a2244b26735d364264db49d6988553d50aa2f76b8c0b1dda9eeb219b23054f131e2294a1b9293ca6c30fb3fa6b06d61074fb9b1e8c09858d1cf4d769275d03d4)
Recovered signature: 154076da22e2b56a29ad822516eda7b64f7f84ad8b255a81b6397bb27465903fe288bd1789a6dc7cc42311ff5651de1011d82896d8c52a4c374550a8f3251ff5899d8e6f41a8f4295ad910db12b58b68e0ffc519916da13aaba27ee70c63d114182da47c5598412334c859f858b98a97f351fa81efa3a3d0fa5dd744009c2443944223d58932b3847b58d688913013dc18255a1f755a7f419785c90ca64811b4eb534c984b3bf1218b2648771ece12074b72678d9104e789762ca69d44d900a5
Recovered signature matches!
```
